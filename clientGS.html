<script>



var arr = [];
console.log(arr);

document.addEventListener('DOMContentLoaded', function() {
    var elems = document.querySelectorAll('select');
    var instances = M.FormSelect.init(elems);
});


   
document.getElementById("hdw").style.display = "none";
document.getElementById("infoMsg").style.display = "block";
document.getElementById("infoMsg").style.display = "none";


//Toggle Hardware option    
document.getElementById('hide').addEventListener("click",toggle);
       
         function toggle(){
            var show = document.getElementById('hdw');
  
        if(show.style.display === 'block'){
          show.style.display = 'none'
        }else{
          show.style.display = 'block';
         }
        }
        
       
//Show Information square
  document.getElementById('complexity').addEventListener("change",toggleInfoSqr);
            function toggleInfoSqr (){
            var value = document.getElementById('complexity').value;
            if(value ==='Simple'){
                document.getElementById("infoMsg").innerHTML = "ⓘ   Simple to install items such as screws.";
                document.getElementById("infoMsg").style.display = "inline-block";  
               }else if  (value ==='Medium'){
                    document.getElementById("infoMsg").innerHTML = "ⓘ    Medium complexity items, rivetting.";
                    document.getElementById("infoMsg").style.display = "inline-block";   
                     }else if(value ==='Complex'){
                         document.getElementById("infoMsg").innerHTML = "ⓘ Complex items including soldering.";
                          document.getElementById("infoMsg").style.display = "inline-block";
                         }
                }            
            
            


//     ESTIMATE BUTTON , SUBMIT OBJECT WITH VALUE TO SERVER
 document.getElementById('submit').addEventListener("click",estimate);
 
 
 //SHOW PRICING AS SUBMITTED
 const yourEstimation = document.querySelector('.yourEst');
 yourEstimation.style.display = 'none';
 
  var i = 0;

function estimate(){
  
     var userInfo = {};
     var ids = document.querySelectorAll('*[id]'); 
     
           ids.forEach(element => {
                if (element.id.length < 15){
                   userInfo[element.id] = element.value;
                   }
             });
      userInfo.hide = document.querySelector('#hide').checked;
      
//  google.script.run.estimate(userInfo);
       i++;
  google.script.run.withSuccessHandler(printEstimate).estimate(userInfo); 
   
   }
   
//TOGGLE PRICE ON MASTER RIGHT
var estimation = document.querySelector('.estimation1');
estimation.style.display = 'none';


function printEstimate (userInfo){
      yourEstimation.style.display = 'block';
      estimation.style.display = 'block';
      exp.style.display = 'block';
      
      var price = document.createElement('div');
       price.classList.add('printEstimation');
       price.innerText  = `Estimation ${i}
       Material: ${userInfo.material} with ${userInfo.bending} bendings. Hardware: ${userInfo.hide === true ? 'Yes' : 'No'}
       Sheet Area: ${Math.round(userInfo.surfaceArea *1000 )/1000}m², Total Volume: ${Math.round(userInfo.weight *1000)/1000}Kgs, 
       Estimated Price$: ${Math.round(userInfo.estimation * 1000)/1000} `;
      estimation.prepend(price);
      
      var jason = JSON.stringify(userInfo);
     
       arr.push(jason);
       
       console.log(arr);
    }
    
  
  var exp = document.querySelector('.export');
  exp.style.display = 'none';
  
  //Find and replace
  exp.addEventListener("click", function (){
        
   google.script.run.withSuccessHandler(printUrl).toGS(arr);
   
  });

   function printUrl(address){
     var link = document.createElement('a');
     link.target="_blank";
     link.href = address;
     link.innerText = 'Export complete. Click here to go to GS';
     
     document.querySelector('.GSLink').append(link);
     
 }














</script>



